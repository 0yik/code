<?xml version="1.0" encoding="utf-8" ?>
<odoo>
    <data>

        <record id="promotion_request_form_view" model="ir.ui.view">
            <field name="name">Promotion Request Form View</field>
            <field name="model">promotion.request</field>
            <field name="arch" type="xml">
                <form string="Promotion Request">
                    <header>
                        <button name="submit_request" string="Submit Request" type="object" class="btn-primary"
                                attrs="{'invisible': [('status', '!=', 'draft')]}"/>

                        <button name="approved_request" string="Approve Request" type="object" class="btn-primary"
                                attrs="{'invisible': [('status', 'not in', ['waiting_dept_approval', 'waiting_hr_approval'])]}"
                                confirm="Are you sure to Approve this promotion request ?"/>

                        <button name="reject_request" string="Reject Request" type="object" class="btn-primary"
                                attrs="{'invisible': [('status', 'not in', ['waiting_dept_approval', 'waiting_hr_approval'])]}"
                                confirm="Are you sure to Reject this promotion request ?"/>

                        <field name="status" widget="statusbar"
                               statusbar_visible="draft,waiting_dept_approval,waiting_hr_approval,approved"/>
                    </header>
                    <sheet>
                        <group>
                            <group>
                                <field name="employee_id" required="1" options="{'no_create_edit': True}"
                                       domain="[('company_id','=',company_id)]"/>
                                <field name="req_date"/>
                                <field name="promo_date" attrs="{'required': [('status','=','approved')]}"/>
                                <field name="transfer_company_id" required="1"/>
                                <field name="promoted_to" required="1"
                                       domain="[('id','!=',job_id),('address_id','=',transfer_company_id)]"
                                       options="{'no_create_edit': True}"/>
                            </group>
                            <group>
                                <field name="job_id"/>
                                <field name="company_id" readonly="1"/>
                                <field name="join_date"/>
                                <field name="next_approver_ids" options="{'no_create_edit': True}" required="1"
                                       widget="many2many_tags"/>
                                <field name="cmt_by_mng"/>
                            </group>
                        </group>
                        <div>
                            <group string="Goals for Promotion" colspan="4">
                                <field name="goal_promo_ids" nolabel="1" colspan="4">
                                    <tree string="Goals for Promotion" editable="bottom" create="false" delete="false">
                                        <field name="goal_defination" options="{'no_create_edit': True}" invisible="1"/>
                                        <field name="goal_description" readonly="1"/>
                                        <field name="goal_performance" readonly="1"/>
                                        <field name="target_value_reach" readonly="1"/>
                                        <field name="value_reached_by_emp"/>
                                    </tree>
                                </field>
                            </group>
                        </div>
                    </sheet>
                </form>
            </field>
        </record>

        <record id="hr_promotion_request_view" model="ir.ui.view">
            <field name="name">hr.promotion.request.tree.view</field>
            <field name="model">promotion.request</field>
            <field name="arch" type="xml">
                <tree string="Promotion Request">
                    <field name="employee_id"/>
                    <field name="job_id" string="Job Title From"/>
                    <field name="promoted_to" string="Job Title To"/>
                    <field name="req_date"/>
                    <field name="promo_date"/>
                    <field name="department_id"/>
                    <field name="status"/>
                </tree>
            </field>
        </record>


        <record id="action_promotion_request" model="ir.actions.act_window">
            <field name="name">Promotion Request</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">promotion.request</field>
            <field name="view_mode">tree,form</field>
            <field name="view_type">form</field>
            <field name="domain">[]</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click here to create a Promotion Request.
                </p>
            </field>
        </record>

        <record id="action_promotion_request_to_submit" model="ir.actions.act_window">
            <field name="name">Promotion To Submit</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">promotion.request</field>
            <field name="view_mode">tree,form</field>
            <field name="view_type">form</field>
            <field name="domain">[('status','=','draft')]</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click here to create a Promotion Request.
                </p>
            </field>
        </record>

        <record id="action_promotion_request_submited" model="ir.actions.act_window">
            <field name="name">Promotion To Approve</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">promotion.request</field>
            <field name="view_mode">tree,form</field>
            <field name="view_type">form</field>
            <field name="domain">[('status','in',['waiting_dept_approval','waiting_hr_approval'])]</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click here to create a Promotion Request.
                </p>
            </field>
        </record>


        <menuitem id="menu_promotion_request_root" name="Promotion" string="Promotion"
                  parent="hr.menu_hr_root" sequence="100000" groups="base.group_user"/>

        <menuitem id="menu_all_promotion_request" parent="hr_employee_promotion.menu_promotion_request_root"
                  action="hr_employee_promotion.action_promotion_request" sequence="5"/>
        <menuitem id="menu_submit_promotion_request" parent="hr_employee_promotion.menu_promotion_request_root"
                  action="hr_employee_promotion.action_promotion_request_to_submit" sequence="2"/>
        <menuitem id="menu_submitet_promotion_request" parent="hr_employee_promotion.menu_promotion_request_root"
                  action="hr_employee_promotion.action_promotion_request_submited" sequence="3"/>

    </data>
</odoo>