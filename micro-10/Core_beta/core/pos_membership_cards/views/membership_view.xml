<?xml version="1.0" encoding="utf-8"?>
<odoo>
	<data>
		<record id="view_pos_config_settings_inherit" model="ir.ui.view">
			<field name="name">POS configuration settings</field>
			<field name="model">pos.config.settings</field>
			<field name="inherit_id" ref="point_of_sale.view_sale_config_settings_form_pos"/>
			<field name="arch" type="xml">
				<xpath expr="//group" position="after">
				<group string="Membership Card Configuration (When some discount already exists in orderlines)">	
					<group>
						<group>
							<field name='override_existing_discount'/>
						</group>
						<group></group>
						<field name="override_selection" widget="radio" nolabel="1" attrs="{'invisible': [('override_existing_discount', '=', False)]}"/>					
					</group>	
					<group>
						<group>
							<field name='ignore_membership_discount'/>
						</group>
						<group></group>
						<field name="ignore_selection" widget="radio" nolabel="1" attrs="{'invisible': [('ignore_membership_discount', '=', False)]}"/>	
					</group>
				</group>
 				</xpath>
 				<xpath expr="//field[@name='module_pos_reprint']" position="after">	
 					<label for="allow_one_card_per_customer"/>
					<div>
						<div>
							<field name="allow_one_card_per_customer"/>
							<label for="allow_one_card_per_customer" string="Allow only one membership card per customer (It is checked for new cards when they are created.)"/>
						</div>
					</div>
 				</xpath>
			</field>
		</record>

		<record model="ir.ui.view" id='pos_membership_cards.record_search'>
			<field name="name">Membership Card Record Search</field>
			<field name="model">pos.membership.card</field>
			<field name="arch" type="xml">
				<search string="Card Records">
					<group expand="0" string="Group By">
						<filter  string="Category"   name='group_by_category' context="{'group_by':'card_category'}"/>
						<filter  string="Customer"   name='group_by_customer'  context="{'group_by':'customer_id'}"/>
					</group>
				</search>
			</field>
		</record>

		<record id="pos_membership_category_form_view" model="ir.ui.view">
			<field name="name">Membership Template</field>
			<field name="model">pos.membership.category</field>
			<field name="arch" type="xml">
				<form string="Membership Template">
					<sheet>
						<group>
							<group>
								<field name="name"/>
								<field name="discount"/>
							</group>
							<group>
								<field name="max_validity"/>
							</group>
						</group>
					</sheet>
				</form>
			</field>
		</record>

		<record id="pos_membership_card_form_view" model="ir.ui.view">
			<field name="name">Membership Card</field>
			<field name="model">pos.membership.card</field>
			<field name="arch" type="xml">
				<form string="Membership Card">
					<header>
						<button name="card_confirm" string="Confirm" states="draft" type='object'/>
						<button name="card_cancel" string="Cancel" states="draft,confirm" type='object'/>
						<button class="oe_highlight" name="%(membership_card_report)d" string="Print" type="action" attrs="{'invisible': [('state','!=','confirm')]}"/>
						<field name="state" widget="statusbar"/>
					</header>
					<sheet>
						<group>
							<group>
								<field name="user_id" invisible="True"/>
								<field name="card_category" widget="selection" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
								<field name="customer_id" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
								<field name="issue_date" required="1" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
								<field name="expiry_date" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
							</group>
							<group>
								<field name="validity"/>
								<field name="card_code" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
								<button name="generate_code" string="Generate Code" type='object' class='oe_highlight' attrs="{'invisible': [('state', '!=', 'draft')]}"/>
							</group>
						</group>
					</sheet>
				</form>
			</field>
		</record>

		<record id="pos_membership_card_tree_view" model="ir.ui.view">
			<field name="name">Membership Card</field>
			<field name="model">pos.membership.card</field>
			<field name="arch" type="xml">
				<tree string="Membership Card" colors="red:state=='cancel'; green:state=='confirm'; blue: state == 'draft'">
					<field name="card_category"/>
					<field name="customer_id"/>
					<field name="expiry_date"/>
					<field name="state"/>
				</tree>
			</field>
		</record>

		<record id="pos_membership_category_tree_view" model="ir.ui.view">
			<field name="name">Membership Template</field>
			<field name="model">pos.membership.category</field>
			<field name="arch" type="xml">
				<tree string="Membership Template">
					<field name="name"/>
					<field name="discount"/>
				</tree>
			</field>
		</record>

		<record id="pos_membership_category_action" model="ir.actions.act_window">
			<field name="name">Membership Template</field>
			<field name="res_model">pos.membership.category</field>
			<field name="view_type">form</field>
			<field name="view_mode">tree,form</field>
		</record>

		<record id="pos_membership_card_action" model="ir.actions.act_window">
			<field name="name">Membership Card</field>
			<field name="res_model">pos.membership.card</field>
			<field name="view_type">form</field>
			<field name="context">{"search_default_group_by_category":1}</field>
			<field name="view_mode">tree,form</field>
		</record>

		<menuitem id="pos_membership_main_menu" parent="point_of_sale.menu_point_root" name='Customer Membership'/>
		<menuitem id="pos_membership_card_menu" parent="pos_membership_main_menu" name='Membership Card' action="pos_membership_card_action"/>
		<menuitem id="pos_membership_category_menu" parent="pos_membership_main_menu" name='Membership Template' action="pos_membership_category_action" groups="point_of_sale.group_pos_manager"/>

	</data>
</odoo>